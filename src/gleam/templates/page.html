{% extends "base.html" %}

{% block title %}{{ title }}{% endblock %}

{% block css %}
<link rel="stylesheet" href="/static/css/styles.css" />
{% endblock %}

{% block js %}
    <script>
    $(document).ready(function() {
        var extraTab = $("ul.nav-tabs li.active")[0]
        $("[name='extra']").val($(extraTab).attr('id'));
        console.log(extraTab);
        console.log($(extraTab).attr('id'));
        refresh();

        $("#input_form").change(function() {
            refresh();
        });
    });
    
    function refresh() {
        $('#input_form').ajaxSubmit({url: "{{server_path}}", 
                                        type: 'post',
                                        dataType: 'json',
                                        success: showResponse});
    }

    $('.nav-tabs').bind("change", function(e) {
        var extraTab = $("ul.nav-tabs li.active")[0]
        $("[name='extra']").val($(extraTab).attr('id'));
        refresh();
    });

    function showResponse(responseJson) {
        for (var id in responseJson['changes']) {
            for (var attr in responseJson['changes'][id]) {
                $('#'+id).attr(attr, responseJson['changes'][id][attr]);
            }
        }
        $(".loader").hide();
    }
    </script>
{% endblock %}

{% block content %}
    <div class="row">
      <div class="col-md-9">
        <h3 class="text-center">{{ title }}</h3>
      </div>
    </div>
    <div class="row">
        {{ panels }}
    </div>


{% endblock %}
