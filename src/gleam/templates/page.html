{% extends "base.html" %}

{% block title %}{{ title }}{% endblock %}

{% block js %}
    <script>
    $(document).ready(function() {
        refresh();

        $("#widget_form").change(function() {
            refresh();
        });
    });

    function refresh()  {
        $('#widget_form').ajaxSubmit({url: "{{server_path}}", 
                                        type: 'post',
                                        dataType: 'json',
                                        success: showResponse});
    }

    function showResponse(responseJson) {
        for (var id in responseJson['changes']) {
            for (var attr in responseJson['changes'][id]) {
                $('#'+id).attr(attr, responseJson['changes'][id][attr]);
            }
        }
    }
    </script>
{% endblock %}

{% block content %}
    <form id="widget_form" role="form">
    {% for field in form %}
        {{ field.label }} {{ field }}
    {% endfor %}
    </form>

    {% for output in outputs %}
        {{ output }}
    {% endfor %}


{% endblock %}
